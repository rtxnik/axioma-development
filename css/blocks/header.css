/* ===============================================
   БЛОК: HEADER (БЭМ) - Улучшенная версия 2.0
   =============================================== */

.header {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	z-index: var(--z-fixed);
	background: var(--bg-opacity-95);
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
	border-bottom: 1px solid var(--bg-white-opacity-10);
	box-shadow: 0 4px 32px rgba(0, 0, 0, 0.1);
	transition: all var(--transition-base);
	animation: slideDown 0.6s var(--ease-out-expo);
	/* Оптимизация производительности */
	will-change: transform, opacity;
	transform: translateZ(0);
	backface-visibility: hidden;
	-webkit-backface-visibility: hidden;
}

/* Псевдоэлемент для градиента */
.header::before {
	content: "";
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: linear-gradient(
		90deg,
		rgba(102, 126, 234, 0.1) 0%,
		rgba(118, 75, 162, 0.1) 50%,
		rgba(102, 126, 234, 0.1) 100%
	);
	opacity: 0;
	transition: opacity var(--transition-base);
	pointer-events: none;
	z-index: -1;
}

/* Декоративная линия снизу */
.header::after {
	content: "";
	position: absolute;
	bottom: -1px;
	left: 0;
	right: 0;
	height: 1px;
	background: linear-gradient(
		90deg,
		transparent,
		rgba(59, 130, 246, 0.3) 20%,
		rgba(59, 130, 246, 0.3) 80%,
		transparent
	);
	opacity: 0;
	transition: opacity var(--transition-base);
}

/* Состояния хедера */
.header:hover::before {
	opacity: 1;
}

.header:hover::after {
	opacity: 1;
}

.header--scrolled {
	background: var(--bg-opacity-98);
	backdrop-filter: blur(25px) saturate(200%);
	border-bottom-color: rgba(229, 231, 235, 0.3);
	box-shadow: 0 8px 40px rgba(0, 0, 0, 0.15);
}

.header--scrolled::before {
	opacity: 0.5;
}

.header--hidden {
	transform: translateY(-100%);
	box-shadow: none;
}

/* Контейнер хедера */
.header .container {
	position: relative;
	z-index: 1;
}

/* Элементы хедера */
.header__nav {
	position: relative;
}

/* Анимации */
@keyframes slideDown {
	from {
		transform: translateY(-100%);
		opacity: 0;
	}
	to {
		transform: translateY(0);
		opacity: 1;
	}
}

/* Индикатор загрузки (опционально) */
.header__progress {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	height: 2px;
	background: rgba(255, 255, 255, 0.1);
	overflow: hidden;
	opacity: 0;
	transition: opacity var(--transition-base);
}

.header--loading .header__progress {
	opacity: 1;
}

.header__progress-bar {
	height: 100%;
	background: var(--gradient-primary);
	width: 0;
	transition: width 0.3s ease;
	animation: progressShimmer 2s ease-in-out infinite;
}

@keyframes progressShimmer {
	0% {
		background-position: -200% 0;
	}
	100% {
		background-position: 200% 0;
	}
}

/* ===============================================
   АДАПТИВНОСТЬ
   =============================================== */

/* Планшеты */
@media (max-width: 1024px) {
	.header {
		/* Сохраняем тот же стиль на планшетах */
	}
}

/* Мобильные устройства */
@media (max-width: 768px) {
	.header {
		background: var(--bg-opacity-98);
		/* Уменьшаем blur для производительности на мобильных */
		backdrop-filter: blur(15px) saturate(180%);
		-webkit-backdrop-filter: blur(15px) saturate(180%);
	}

	.header::before {
		/* Упрощаем градиент на мобильных */
		background: linear-gradient(
			90deg,
			rgba(102, 126, 234, 0.05) 0%,
			rgba(118, 75, 162, 0.05) 100%
		);
	}

	/* Мобильный хедер при скролле */
	.header--scrolled {
		backdrop-filter: blur(20px) saturate(190%);
	}
}

/* Маленькие экраны */
@media (max-width: 480px) {
	.header {
		/* Еще больше упрощаем эффекты для слабых устройств */
		box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
	}
}

/* ===============================================
   РЕЖИМЫ ДОСТУПНОСТИ
   =============================================== */

/* Режим уменьшенной анимации */
@media (prefers-reduced-motion: reduce) {
	.header {
		animation: none;
		transition: none;
	}

	.header::before,
	.header::after {
		transition: none;
	}

	.header__progress-bar {
		animation: none;
	}
}

/* Высокая контрастность */
@media (prefers-contrast: high) {
	.header {
		background: var(--color-dark);
		border-bottom: 2px solid var(--color-white);
		backdrop-filter: none;
	}

	.header::before {
		display: none;
	}

	.header--scrolled {
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
	}
}

/* Темная тема системы */
@media (prefers-color-scheme: dark) {
	/* Header уже темный по умолчанию */
}

/* ===============================================
   ОПТИМИЗАЦИЯ ПРОИЗВОДИТЕЛЬНОСТИ
   =============================================== */

/* Для устройств с низкой производительностью */
@media (max-width: 768px) and (hover: none) {
	.header {
		/* Отключаем сложные эффекты */
		backdrop-filter: blur(10px);
		-webkit-backdrop-filter: blur(10px);
	}

	.header::before {
		display: none;
	}
}

/* Поддержка iOS Safe Area */
@supports (padding: max(0px)) {
	.header {
		padding-top: env(safe-area-inset-top);
	}
}

/* ===============================================
   СПЕЦИАЛЬНЫЕ СОСТОЯНИЯ
   =============================================== */

/* Прозрачный хедер (для hero секции) */
.header--transparent {
	background: transparent;
	backdrop-filter: none;
	border-bottom-color: transparent;
	box-shadow: none;
}

.header--transparent:not(:hover):not(.header--scrolled) {
	background: transparent;
}

/* Компактный хедер */
.header--compact {
	--header-height: 60px;
}

.header--compact .nav__wrapper {
	height: 60px;
}

/* Статичный хедер (не fixed) */
.header--static {
	position: relative;
	animation: none;
}

/* ===============================================
   РЕЖИМ ПЕЧАТИ
   =============================================== */

@media print {
	.header {
		position: static;
		background: transparent;
		border-bottom: 1px solid var(--color-light);
		box-shadow: none;
		backdrop-filter: none;
		-webkit-backdrop-filter: none;
	}

	.header::before,
	.header::after,
	.header__progress {
		display: none;
	}
}

/* ===============================================
   ПОДДЕРЖКА СТАРЫХ БРАУЗЕРОВ
   =============================================== */

/* Fallback для браузеров без поддержки backdrop-filter */
@supports not (backdrop-filter: blur(20px)) {
	.header {
		background: rgba(26, 26, 26, 0.98);
	}

	.header--scrolled {
		background: rgba(26, 26, 26, 0.99);
	}
}

/* IE11 поддержка */
@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
	.header {
		background: rgba(26, 26, 26, 0.98);
	}

	.header::before {
		display: none;
	}
}
